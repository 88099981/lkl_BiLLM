Loading checkpoint shards: 100%|███████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.29s/it]
torch.float32
Starting ...
Ready.
The attention layers in this model are transitioning from computing the RoPE embeddings internally through `position_ids` (2D tensor with the indexes of the tokens), to using externally computed `position_embeddings` (Tuple of tensors, containing cos and sin). In v4.46 `position_ids` will be removed and `position_embeddings` will be mandatory.
0 self_attn.q_proj
Quantizing ...
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
time 6.79
error 6403.1748046875
0 self_attn.k_proj
Quantizing ...
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
time 4.89
error 3830.67333984375
0 self_attn.v_proj
Quantizing ...
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
time 4.89
error 508.0286865234375
0 self_attn.o_proj
Quantizing ...
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.7516, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1484, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
time 4.90
error 5.938195705413818
0 mlp.gate_proj
Quantizing ...
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.5797, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3203, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.6422, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2578, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
time 7.19
error 4750.40234375
0 mlp.up_proj
Quantizing ...
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.5797, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3203, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.7828, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1172, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.7750, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1250, device='cuda:6')
tensor(0.7437, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1562, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.7516, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1484, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
time 6.91
error 4433.92041015625
0 mlp.down_proj
Quantizing ...
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.5953, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3047, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8062, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0938, device='cuda:6')
tensor(0.7828, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1172, device='cuda:6')
tensor(0.7672, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1328, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7516, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1484, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8062, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0938, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.7125, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1875, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7594, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1406, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.6031, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2969, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7594, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1406, device='cuda:6')
tensor(0.7750, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1250, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8062, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0938, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8062, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0938, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7672, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1328, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
time 13.33
error 56.124935150146484
1 self_attn.q_proj
Quantizing ...
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
time 6.38
error 21979.703125
1 self_attn.k_proj
Quantizing ...
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8062, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0938, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
time 4.87
error 21882.494140625
1 self_attn.v_proj
Quantizing ...
tensor(0.6031, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2969, device='cuda:6')
tensor(0.7750, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1250, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.7359, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1641, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.7437, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1562, device='cuda:6')
tensor(0.5641, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3359, device='cuda:6')
tensor(0.5172, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3828, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7203, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1797, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7281, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1719, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8062, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0938, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7047, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1953, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
time 4.87
error 2185.67138671875
1 self_attn.o_proj
Quantizing ...
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
time 4.88
error 89.98529052734375
1 mlp.gate_proj
Quantizing ...
tensor(0.6266, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2734, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7984, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1016, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.7125, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1875, device='cuda:6')
tensor(0.5172, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3828, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.6812, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2188, device='cuda:6')
tensor(0.7437, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1562, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7516, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1484, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
time 6.85
error 19134.73828125
1 mlp.up_proj
Quantizing ...
tensor(0.7594, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1406, device='cuda:6')
tensor(0.7437, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1562, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.6031, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2969, device='cuda:6')
tensor(0.7047, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1953, device='cuda:6')
tensor(0.7359, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1641, device='cuda:6')
tensor(0.7047, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1953, device='cuda:6')
tensor(0.7047, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1953, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.7047, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1953, device='cuda:6')
tensor(0.7281, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1719, device='cuda:6')
tensor(0.6031, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2969, device='cuda:6')
tensor(0.8219, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0781, device='cuda:6')
tensor(0.6969, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2031, device='cuda:6')
tensor(0.7203, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1797, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7203, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1797, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7906, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1094, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
time 6.86
error 16151.369140625
1 mlp.down_proj
Quantizing ...
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.5172, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.3828, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.7750, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1250, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7437, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1562, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8375, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0625, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8609, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0391, device='cuda:6')
tensor(0.8141, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0859, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.6812, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.2188, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.7516, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1484, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.7750, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.1250, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8453, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0547, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8687, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0312, device='cuda:6')
tensor(0.8844, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0156, device='cuda:6')
tensor(0.8531, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0469, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
tensor(0.8297, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0703, device='cuda:6')
tensor(0.8766, device='cuda:6') tensor(0.1000, device='cuda:6') tensor(0.0234, device='cuda:6')
time 13.08
error 6448.9970703125
Traceback (most recent call last):
  File "/home/liukunlong/lkl_BiLLM/run.py", line 302, in <module>
    quant_sequential(model, dataloader, device)
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/lkl_BiLLM/run.py", line 161, in quant_sequential
    outs[j] = layer(inps[j].unsqueeze(0), attention_mask=attention_mask, position_ids=position_ids)[0]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 640, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 541, in forward
    query_states, key_states = apply_rotary_pos_emb(query_states, key_states, cos, sin)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 225, in apply_rotary_pos_emb
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ^^^^^^^^^^^^^^
  File "/home/liukunlong/anaconda3/envs/lkl_Billm/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 200, in rotate_half
    return torch.cat((-x2, x1), dim=-1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
